//@ui5-bundle monitorfacturas/detallesfactura/Component-preload.js
sap.ui.require.preload({
	"monitorfacturas/detallesfactura/Component.js":function(){
sap.ui.define(["sap/fe/core/AppComponent"],function(e){"use strict";return e.extend("monitorfacturas.detallesfactura.Component",{metadata:{manifest:"json"}})});
},
	"monitorfacturas/detallesfactura/ext/main/Main.controller.js":function(){
sap.ui.define(["sap/fe/core/PageController","sap/m/MessageToast"],function(e,t){"use strict";return e.extend("monitorfacturas.detallesfactura.ext.main.Main",{onDetallePress:function(e){var t=e.getSource();var o=t.getParent();var n=o.getBindingContext();var r=n.getProperty("NumeroFactura");console.log(r);var a="#monitorfacturasdetallesfactura-display&/Facturas('"+r+"')";window.open(a,"_blank")},formatter:{estadoToState:function(e){if(e==="Aprobado"){return"Success"}else if(e==="Rechazado"){return"Error"}else{return"Warning"}},urgenteToState:function(e){return e?"Error":"Success"},urgenteToText:function(e){return e?"S√≠":"No"}},timeUTC:function(){var e=new Date;var t=new Date(e.getTime()-e.getTimezoneOffset()*6e4);t.setHours(t.getHours()+5);console.log(t.toISOString());return t.toISOString()},createdNonce:function(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;const o=e==="x"?t:t&3|8;return o.toString(16)});console.log(e);var t=btoa(e);return t},getInvoicesList:async function(){var e=this.timeUTC();var o=this.createdNonce();try{const n=await fetch("/service/Monitor_FacturasService/consultar_documentos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({noce:o,created:e})});const r=await n.text();console.log("Respuesta SOAP:",r);const a=r.match(/<availableDocument>[\s\S]*?<\/availableDocument>/g);const c=[];if(a&&a.length>0){a.forEach(e=>{const t=e.match(/<documentNumber>(.*?)<\/documentNumber>/)?.[1]||"";const o=e.match(/<documentPrefix>(.*?)<\/documentPrefix>/)?.[1]||"";const n=e.match(/<documentType>(.*?)<\/documentType>/)?.[1]||"";const r=e.match(/<senderIdentification>(.*?)<\/senderIdentification>/)?.[1]||"";c.push({documentNumber:t,documentPrefix:o,documentType:n,senderIdentification:r})})}console.log("üìã Documentos extra√≠dos:",c);t.show(`Consulta realizada. ${c.length} documentos disponibles.`);return c}catch(e){console.error("Error al consultar:",e);t.show("Error en consulta SOAP");return[]}},getDocuments:async function(){var e=await this.getInvoicesList();for(const n of e){var t=this.timeUTC();var o=this.createdNonce();console.log("N√∫mero de documento:",n.documentNumber);console.log("Prefijo de documento:",n.documentPrefix);console.log("Tipo de documento:",n.documentType);console.log("Identificaci√≥n del remitente:",n.senderIdentification);try{const e=await fetch("/service/Monitor_FacturasService/extraer_documentos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({noce:o,created:t,data:"SIGNED_XML",documentNumber:n.documentNumber,documentPrefix:n.documentPrefix,documentType:n.documentType,senderIdentification:n.senderIdentification})});const r=await e.text();console.log("Respuesta SOAP:",r)}catch(e){console.error("‚ùå Error al extraer documentos:",e)}}},onBuscarFactura:function(e){const t=e.getParameter("query");this._aplicarFiltros(t)},onFiltrarEstadoUrgente:function(){const e=this.byId("searchFactura").getValue();this._aplicarFiltros(e)},_aplicarFiltros:function(e){const t=this.byId("filtroEstado").getSelectedKey();const o=this.byId("filtroUrgente").getSelectedKey();const n=[];if(e){n.push(new sap.ui.model.Filter("NumeroFactura",sap.ui.model.FilterOperator.Contains,e))}if(t){n.push(new sap.ui.model.Filter("Estado",sap.ui.model.FilterOperator.EQ,t))}if(o){n.push(new sap.ui.model.Filter("Urgente",sap.ui.model.FilterOperator.EQ,o))}const r=this.byId("FacturaList");const a=r.getBinding("items");if(a){a.filter(n)}else{console.warn("No se encontr√≥ el binding de la lista")}}})});
},
	"monitorfacturas/detallesfactura/ext/main/Main.view.xml":'<mvc:View xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" xmlns:macros="sap.fe.macros" xmlns:html="http://www.w3.org/1999/xhtml" controllerName="monitorfacturas.detallesfactura.ext.main.Main"><Page id="Main" title=""><content></content><Toolbar id="FiltroToolbar" class="sapUiSmallMarginBottom barraFiltros"><Button id="myButton" text="Insertar Facturas" press="getDocuments" class="buttonHeader"/><Select id="filtroEstado" change=".onFiltrarEstadoUrgente"><core:Item id="key1" key="" text="Todos los estados" /><core:Item id="key2" key="Aprobado" text="Aprobado" /><core:Item id="key3" key="Rechazado" text="Rechazado" /></Select><Select id="filtroUrgente" change=".onFiltrarEstadoUrgente"><core:Item id="key4" key="" text="Todos" /><core:Item id="key5" key="S√≠" text="S√≠" /><core:Item id="key6" key="No" text="No" /></Select><SearchField id="searchFactura" width="20rem" placeholder="Buscar n√∫mero de factura..." search=".onBuscarFactura"/></Toolbar><List id="FacturaList" items="{/Facturas}" headerText="Facturas" growing="true" growingScrollToLoad="true"><CustomListItem id="FacturaCardItem"><VBox id="VBoxFacturaCard" class="facturaCard sapUiSmallMargin sapUiTinyMarginTop sapUiTinyMarginBottom"><HBox id="HBoxEncabezadoFactura" justifyContent="SpaceBetween"><Text id="TextNumeroFactura" text="{NumeroFactura}" class="sapMTitle"/><ObjectStatus id="EstadoFacturaStatus" text="{Estado}" state="{ path: \'Estado\', formatter: \'.formatter.estadoToState\' }"/><Button id="BtnVerDetallesFactura" text="" icon="sap-icon://action" type="Transparent" press="onDetallePress" class="sapUiTinyMarginTop"/></HBox><HBox id="HBoxContenidoFactura" justifyContent="SpaceBetween" class="facturaContenido sapUiTinyMarginTop" wrap="Wrap"><VBox id="VBoxColumna1" class="facturaColumna"><Text id="TextFechaFactura" text="Fecha Factura: {FechaFactura}"/><ObjectStatus id="UrgenteFacturaStatus" text="{ path: \'Urgente\', formatter: \'.formatter.urgenteToText\' }" state="{ path: \'Urgente\', formatter: \'.formatter.urgenteToState\' }"/></VBox><VBox id="VBoxColumna2" class="facturaColumna"></VBox></HBox></VBox></CustomListItem></List></Page></mvc:View>',
	"monitorfacturas/detallesfactura/ext/view/Informaciongeneral.controller.js":function(){
sap.ui.define(["sap/fe/core/PageController","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageToast"],function(e,t,r,n){"use strict";return e.extend("monitorfacturas.detallesfactura.ext.view.Informaciongeneral",{onAfterRendering:function(){console.log("‚úîÔ∏è onAfterRendering ejecutado");setTimeout(()=>{this.mostrarPdfEnIframe()},500)},mostrarPdfEnIframe:function(){const e=this.byId("pdfEmbed");const t=this.getView().getBindingContext();if(!t){console.error("No hay contexto de factura");return}const r=t.getProperty("NumeroFactura");const n=this.getOwnerComponent().getModel();const o=n.sServiceUrl;const a=o+"/Facturas('"+r+"')/archivoPDF/$value";const i=`\n                <iframe\n                    src="${a}"\n                    width="100%"\n                    height="800px"\n                    style="border: none;"\n                ></iframe>\n            `;e.setContent(i)},onDetallePress:function(e){var t=e.getSource();var r=t.getParent();var n=r.getBindingContext();var o=n.getProperty("NumeroEntrada");var a="#monitorfacturasentradas-display&/Entrada('"+o+"')";window.open(a,"_blank")},onDetallePressOrden:function(e){var t=e.getSource();var r=t.getParent();var o=r.getBindingContext();var a=o.getProperty("NumeroMaterial");var i=this.getView().getModel();var s="NumeroMaterial eq '"+a+"'";i.bindList("/DetalleOrdenCompra",null,null,null,{$filter:s}).requestContexts().then(function(e){if(e.length>0){var t=e[0].getObject();var r=t.ID;var o="#monitorfacturasdetalleorden-display&/DetalleOrdenCompra(ID="+r+",IsActiveEntity=true)";window.open(o,"_blank")}else{n.show("No se encontr√≥ el material.")}}).catch(function(){n.show("Error al consultar DetalleOrdenCompra.")})}})});
},
	"monitorfacturas/detallesfactura/ext/view/Informaciongeneral.view.xml":'<mvc:View\r\n    xmlns:core="sap.ui.core"\r\n    xmlns:mvc="sap.ui.core.mvc"\r\n    xmlns="sap.m"\r\n    xmlns:layout="sap.ui.layout.form"\r\n    xmlns:pdf="sap.m"\r\n    controllerName="monitorfacturas.detallesfactura.ext.view.Informaciongeneral"\r\n    xmlns:macros="sap.fe.macros"><Page id="pageInformacionGeneral" title="Factura"><content><HBox id="mainHBox" width="100%"><VBox id="leftVBox" width="50%" renderType="Bare"><layout:SimpleForm\r\n                    id="facturaForm"\r\n                    editable="false"\r\n                    layout="ResponsiveGridLayout"\r\n                    labelSpanL="4"\r\n                    labelSpanM="4"\r\n                    columnsL="2"\r\n                    columnsM="2"\r\n                    columnsXL="2"\r\n                    singleContainerFullSize="false"\r\n                    title="Datos de la Factura"><Toolbar id="toolbarGeneral"><Title id="titleGeneral" text="Informaci√≥n General" level="H4" /></Toolbar><Label id="lblNumeroFactura" text="N√∫mero Factura" /><Text id="txtNumeroFactura" text="{NumeroFactura}" /><Label id="lblProveedor" text="Proveedor" /><Text id="txtProveedor" text="{Proveedor/Nombre1}" /><Label id="lblEstado" text="Estado" /><Text id="txtEstado" text="{Estado}" /><Label id="lblUrgente" text="Urgente" /><Text id="txtUrgente" text="{Urgente}" /><Label id="lblFacturaElec" text="Factura Electr√≥nica" /><Text id="txtFacturaElec" text="{FacturaElec}" /><Label id="lblDescuento" text="Descuento pronto pago" /><Text id="txtDescuento" text="{Descuento}" /><Label id="lblComentario" text="Comentario" /><Text id="txtComentario" text="{Comentario}" /><Toolbar id="toolbarFechas"><Title id="titleFechas" text="Fechas" level="H4" /></Toolbar><Label id="lblFechaFactura" text="Fecha Factura" /><Text id="txtFechaFactura" text="{FechaFactura}" /><Label id="lblFechaContabilizacion" text="Fecha Contabilizaci√≥n" /><Text id="txtFechaContabilizacion" text="{FechaContabilizacion}" /><Label id="lblFechaVencimiento" text="Fecha Vencimiento" /><Text id="txtFechaVencimiento" text="{FechaVencimiento}" /><Label id="lblFechaRecepcion" text="Fecha de recepci√≥n" /><Text id="txtFechaRecepcion" text="{FechaRecepcion}" /><Toolbar id="toolbarPago"><Title id="titlePago" text="Datos de Pago" level="H4" /></Toolbar><Label id="lblFormaPago" text="Forma de pago" /><Text id="txtFormaPago" text="{FormaPago}" /><Label id="lblPosiciones" text="Posiciones" /><Text id="txtPosiciones" text="{Posiciones}" /><Toolbar id="toolbarValores"><Title id="titleValores" text="Valores Monetarios" level="H4" /></Toolbar><Label id="lblTotalFactura" text="Total de factura" /><Text id="txtTotalFactura" text="{TotalFactura}" /><Label id="lblValorFinal" text="Valor final a pagar" /><Text id="txtValorFinal" text="{ValorFinal}" /><Label id="lblIVA" text="IVA" /><Text id="txtIVA" text="{IVA}" /><Label id="lblIndicadorImpuesto" text="Indicador de impuesto" /><Text id="txtIndicadorImpuesto" text="{IndicadorImpuesto}" /><Label id="lblNumeroIndicador" text="N√∫mero indicador" /><Text id="txtNumeroIndicador" text="{NumeroIndicador}" /><Toolbar id="toolbarDestinatario"><Title id="titleDestinatario" text="Destinatario y Clasificaci√≥n" level="H4" /></Toolbar><Label id="lblDestinatario" text="Destinatario" /><Text id="txtDestinatario" text="{Destinatario}" /><Label id="lblDescDestinatario" text="Descripci√≥n del destinatario" /><Text id="txtDescDestinatario" text="{DescripcionDestinatario}" /><Label id="lblCodigoActividad" text="C√≥digo de actividad" /><Text id="txtCodigoActividad" text="{CodigoActividad}" /><Label id="lblClasificacion" text="Clasificaci√≥n" /><Text id="txtClasificacion" text="{Clasificacion}" /><Label id="lblArea" text="√Årea" /><Text id="txtArea" text="{Area}" /><Label id="lblSede" text="Sede" /><Text id="txtSede" text="{Sede}" /><Label id="lblDocumentoMIRO" text="Documento MIRO" /><Text id="txtDocumentoMIRO" text="{DocumentoMIRO}" /><Label id="lblDocumentoFI" text="Documento FI" /><Text id="txtDocumentoFI" text="{DocumentoFI}" /></layout:SimpleForm><VBox id="detalleFacturaVBox" class="sapUiMediumMarginTop"></VBox><VBox id="entradasVBox" class="sapUiMediumMarginTop"></VBox></VBox><VBox id="rightVBox" width="50%" class="sapUiContentPadding"><Title id="titlePdf" text="Visualizaci√≥n PDF" level="H4" /><core:HTML id="pdfEmbed" content="" /></VBox></HBox><Table id="tablaDetalleFactura" items="{DetalleFactura}" headerText="Detalles de la Factura"><columns><Column id="columna1"><Text id="11" text="N√∫mero Material" /></Column><Column id="columna2" ><Text id="22" text="Descripci√≥n" /></Column><Column id="columna3" ><Text id="33" text="Cantidad" /></Column><Column id="columna4" ><Text id="44" text="Valor Unitario" /></Column><Column id="column5" ><Text id="55" text="Valor Total" /></Column><Column id="columna6" ><Text id="66" text="Detalles" /></Column></columns><items><ColumnListItem id="detalleFacturaItem"><cells><Text id="1" text="{NumeroMaterial}" /><Text id="2" text="{Descripcion}" /><Text id="3" text="{Cantidad}" /><Text id="4" text="{ValorUnitario}" /><Text id="5" text="{ValorTotal}" /><Button id="6" text="Ver O.C" icon="sap-icon://show" type="Transparent" press="onDetallePressOrden" /></cells></ColumnListItem></items></Table><Table id="tablaEntradas" items="{Entrada}" headerText="Entradas asociadas a la Factura"><columns><Column id="Columna1"><Text id="Texto1" text="Fecha de emisi√≥n" /></Column><Column id="Columna2"><Text id="Texto2" text="Fecha de recepci√≥n" /></Column><Column id="Columna3"><Text id="Texto3" text="N√∫mero de entrada" /></Column><Column id="Columna4"><Text id="Texto4" text="Detalles" /></Column></columns><items><ColumnListItem id="entradaItem"><cells><Text id="Texto5" text="{FechaEmision}" /><Text id="Texto6" text="{FechaRecepcion}" /><Text id="Texto7" text="{NumeroEntrada}" /><Button id="Boton2" text="Ver detalles" icon="sap-icon://show" type="Transparent" press="onDetallePress" /></cells></ColumnListItem></items></Table></content></Page></mvc:View>\r\n',
	"monitorfacturas/detallesfactura/i18n/i18n.properties":'# This is the resource bundle for monitorfacturas.detallesfactura\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Detalles Factura\n\n#YDES: Application description\nappDescription=Gesti\\u00f3n detalles factura\n#XTIT: Custom view title\nMainTitle=Main\n\n#XFLD,48\nmonitorfacturasdetallesfactura-display.flpTitle=Detalles Factura\n#XTIT: Custom view title\nInformaciongeneralTitle=Informaciongeneral\n#XTIT: Custom view title\nOrdenCompraTitle=OrdenCompra',
	"monitorfacturas/detallesfactura/manifest.json":'{"_version":"1.60.0","sap.app":{"id":"monitorfacturas.detallesfactura","type":"application","i18n":"i18n/i18n.properties","applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:fpm","version":"1.17.1","toolsId":"83512586-e70c-41c7-ba65-96dde24129b4"},"dataSources":{"mainService":{"uri":"service/Monitor_FacturasService/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}},"crossNavigation":{"inbounds":{"monitorfacturasdetallesfactura-display":{"semanticObject":"monitorfacturasdetallesfactura","action":"display","title":"{{monitorfacturasdetallesfactura-display.flpTitle}}","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.120.13","libs":{"sap.m":{},"sap.ui.core":{},"sap.fe.core":{},"sap.fe.macros":{},"sap.fe.templates":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"monitorfacturas.detallesfactura.i18n.i18n"}},"":{"dataSource":"mainService","preload":true,"settings":{"operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}},"@i18n":{"type":"sap.ui.model.resource.ResourceModel","uri":"i18n/i18n.properties"}},"resources":{"js":[],"css":[{"uri":"css/style.css"}],"others":[{"uri":"pdfPrueba/","type":"static"}]},"routing":{"config":{},"routes":[{"name":"DetalleFacturaMain","pattern":":?query:","target":"DetalleFacturaMain"},{"name":"FacturasInformaciongeneralPage","pattern":"Facturas({FacturasKey}):?query:","target":"FacturasInformaciongeneralPage"}],"targets":{"DetalleFacturaMain":{"type":"Component","id":"DetalleFacturaMain","name":"sap.fe.core.fpm","options":{"settings":{"navigation":{"Facturas":{"detail":{"route":"FacturasInformaciongeneralPage"}}},"contextPath":"/DetalleFactura","viewName":"monitorfacturas.detallesfactura.ext.main.Main"}}},"FacturasInformaciongeneralPage":{"type":"Component","id":"FacturasInformaciongeneralPage","name":"sap.fe.core.fpm","options":{"settings":{"navigation":{},"contextPath":"/Facturas","viewName":"monitorfacturas.detallesfactura.ext.view.Informaciongeneral"}}}}}},"sap.fiori":{},"sap.cloud":{"public":true,"service":"lcap.Monitor_Facturas"}}'
});
//# sourceMappingURL=Component-preload.js.map
